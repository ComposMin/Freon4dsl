<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adjusting the Generator Editor :: ProjectIt - A Projectional Editor Framework for the Web</title>
    <link rel="canonical" href="https://projectit-org.github.io/ProjectIt/projectit-documentation/0.0.5/projectit-main/tutorials/Framework-Tutorial.html">
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://projectit-org.github.io/ProjectIt">ProjectIt - A Projectional Editor Framework for the Web</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://projectit-org.github.io/ProjectIt">Home</a>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://github.com/joswarmer/ProjectIt/">GitHub</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="main-wrapper">
<div class="navigation-container" data-component="projectit-documentation" data-version="0.0.5">
  <aside class="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">ProjectIt Developer Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../Projectional-Overview.html">What is Projectional Editing?</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../Installation-Guide.html">Installing ProjectIt</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../Framework-Description.html">The ProjectIt Framework</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Different-Boxes.html">Types of Boxes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../Supporting-Expressions.html">Support for Expressions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../DemoLanguage-Example.html">DemoLanguage Example</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Tutorials</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Metamodels-Tutorial.html">Tutorial 1: Creating a Metamodel</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Generation-Tutorial.html">Tutorial 2: Generating an Editor</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="Framework-Tutorial.html">Tutorial 3: Adjusting an Editor</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../../projectit-meta/Sourcecode-Documentation.html">The ProjectIt Source Code</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../projectit-meta/Implementing-PiProjection.html">Implementing PiProjection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../projectit-meta/projectit-decorators.html">Supporting Decorators</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">ProjectIt Developer Documentation</span>
    <span class="version">0.0.5</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">ProjectIt Developer Documentation</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">0.0.5</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="../../index.html" class="home-link"></a>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="../../index.html">ProjectIt Developer Documentation</a></li>
    <li class="crumb">Tutorials</li>
    <li class="crumb"><a href="Framework-Tutorial.html">Tutorial 3: Adjusting an Editor</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/projectit-org/ProjectIt/edit/feature/documentation/packages/docs/component-main/modules/projectit-main/pages/tutorials/Framework-Tutorial.adoc">Edit this Page</a></div>
</div>
<article class="doc">
<h1>Adjusting the Generator Editor</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>If the generated editor does not completely fullfill your whishes with regard to its look and feel, you can improve the generated editor by hand. There are two axes along which you can adjust the editor: (1) <a href="#_changing_the_projection">Changing the Projection</a> and (2) <a href="#_define_your_own_actions">Define your Own Actions</a>.</p>
</div>
</div>
</div>
<h1 id="_changing_the_projection" class="sect0"><a class="anchor" href="#_changing_the_projection"></a>Changing the Projection</h1>
<div class="paragraph">
<p>In this tutorial we will use the <a href="../DemoLanguage-Example.html" class="page">DemoLanguage</a>, a simple language where a model has entities, and entities have attributes, as example.</p>
</div>
<div class="paragraph">
<p>The projections in this tutorial are all available in <code>packages/demo/src/editor/TutorialProjection.ts</code>.</p>
</div>
<div class="sect1">
<h2 id="_default_projection_of_the_model_name"><a class="anchor" href="#_default_projection_of_the_model_name"></a>Default Projection of the Model Name</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The name of the model in our DemoLanguage is the value of the attribute <em>name</em> of class <em>DemoModel</em></p>
</div>
<div class="listingblock">
<div class="title">Model Element</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">export class DemoModel extends DemoModelElement {
    @observable name: string;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default projection for this is a <code>HorizontalListBox</code> which holds a 'LabelBox' with the name of the class, followed by the value stored in the variable model.name. In the tutorial example this value is "DemoModel". When we start the editor based on this projection, we see the following:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/demomodel-name.png" alt="demomodel name">
</div>
</div>
<div class="paragraph">
<p>It doesn&#8217;t look very nice currently:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The label is not distinguishable from the name of the model.</p>
</li>
<li>
<p>When the name of the model becomes empty, there is no visual clue that you can add a name.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_step_1_adding_style"><a class="anchor" href="#_step_1_adding_style"></a>Step 1 - Adding Style</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s have a look at the code that implements the projection:</p>
</div>
<div class="listingblock">
<div class="title">Default Projection</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">    private createModelBox(model: DemoModel): Box {
        return new HorizontalListBox(model, "model", [
            new LabelBox(model, "model-label", "DemoModel"),
            new TextBox(model, "model-name", () =&gt; model.name, (c: string) =&gt; (model.name = c))
        ]);
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next we add a style to the LabelBox:</p>
</div>
<div class="listingblock">
<div class="title">Projection with Style and Placeholder</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">    private createModelBox2(model: DemoModel): Box {
        return new HorizontalListBox(model, "model", [
            new LabelBox(model, "model-label", "Model", {
                style: demoStyles.keyword
            }),
            new TextBox(model, "model-name", () =&gt; model.name, (c: string) =&gt; (model.name = c), {
                placeHolder: "&lt;name&gt;"
            })
        ]);
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>LabelBox</code> now has the style <code>demoStyles.keyword</code> associated with it, so it will show in a different color.
Also, the <code>TextBox</code> has a <code>placeHolder</code> property.  This placeholder will show whenever the contents of the <code>TextBox</code>
is empty, giving the user a visual clue that a name could be entered.</p>
</div>
<div class="paragraph">
<p>The result is:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/demomodel-name-with-style.png" alt="demomodel name with style">
</div>
</div>
<div class="paragraph">
<p>The style is defined in a css (or actually scss) as follows. In principle all CSS styles can be used here.</p>
</div>
<div class="listingblock">
<div class="title">CSS for Styled Projection</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-css hljs" data-lang="css">.keyword {
    font-weight: bold;
    color: blue;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_step_3_showing_contained_elements"><a class="anchor" href="#_step_3_showing_contained_elements"></a>Step 3 - Showing Contained Elements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We will add the entities owned by the <code>DemoModel</code> to the projection.</p>
</div>
<div class="listingblock">
<div class="title">Projection of Child Elements</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">    private createModelBox3(model: DemoModel): Box {
        return new VerticalListBox(model, "model", [
            new HorizontalListBox(model, "model-info", [
                new LabelBox(model, "model-keyword", "Model", {
                    style: demoStyles.keyword
                }),
                new TextBox(model, "model-name", () =&gt; model.name, (c: string) =&gt; (model.name = c), {
                    placeHolder: "&lt;name&gt;"
                })
            ]),
            new LabelBox(model, "entity-keyword", "Entities", {
                style: demoStyles.keyword
            }),
            new VerticalListBox(
                model,
                "entity-list",
                model.entities.map(ent =&gt; {
                    return this.createEntityBox(ent);
                })
            )
        ]);
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The entities will be below the model name and for this we use a <code>VerticalListBox</code>.
First we show the model keyword plus its name,
the we show the keyword <em>Entities</em>,
followed by another <code>VerticalListBox</code> of all entities.
The projection of an entity is defined in a separate function:</p>
</div>
<div class="listingblock">
<div class="title">Projection of Entity</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">    private createEntityBox(entity: DemoEntity): Box {
        return new VerticalListBox(entity,"entity",
            [
                new HorizontalListBox(entity, "entity-info", [
                    new LabelBox(entity, "entity-keyword", "Entity", {
                        style: demoStyles.keyword
                    }),
                    new TextBox(entity, "entity-name", () =&gt; entity.name, (c: string) =&gt; (entity.name = c), {
                        placeHolder: "&lt;name&gt;"
                    })
                ]),
                new VerticalListBox( entity, "attribute-list",
                    entity.attributes.map(att =&gt; {
                        return this.createAttributeBox(att);
                    })
                )
            ],
            { style: demoStyles.indent }
        );
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This function is very similar to the projection of the model box,
showing the keyword <em>Entity</em> followed by its name and below all attributes of the
entity in a <code>VerticalListBox</code>.</p>
</div>
<div class="paragraph">
<p>Once again, the projection of an attribute is defined in its own function.</p>
</div>
<div class="listingblock">
<div class="title">Projection of Attribute</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">    private createAttributeBox(att: DemoAttribute): Box {
        return new HorizontalListBox(
            att,
            "attribute",
            [
                new TextBox(att,"attribute-name",
                    () =&gt; { return att.name; },
                    (v: string) =&gt; { att.name = v; }
                ),
                new LabelBox(att, "colon", ":"),
                new TextBox(att,"attribute-type",
                    () =&gt; { return att.type; },
                    (v: string) =&gt; { att.type = v as DemoAttributeType; }
                )
            ],
            { style: demoStyles.indent }
        );
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_step_4_allow_creation_of_new_elements_in_the_editor"><a class="anchor" href="#_step_4_allow_creation_of_new_elements_in_the_editor"></a>Step 4 - Allow Creation of new Elements in the Editor</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The projection sofar is exactly that: a projection.
There are no actions defined yet, which we need to make a functioning editor.</p>
</div>
<div class="paragraph">
<p>This step is explained in the <a href="#tutorials/Actions-Tutorial.adoc" class="page unresolved">Actions</a> tutorial.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_define_your_own_actions"><a class="anchor" href="#_define_your_own_actions"></a>Define your Own Actions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the <a href="#tutorials/Projection-Tutorial.adoc" class="page unresolved">Projection Tutorial</a> we started out by creating a projection of the DemoModel.
In this tutorial we will add actions to the editor,
to enable the user to change the model and add elements to it.</p>
</div>
<div class="paragraph">
<p>First of all take a look at the built-in default behavior of the editor:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inside a TextBox the text can be edited.</p>
</li>
<li>
<p>Using the arrow keys the user can navigate the projection.</p>
</li>
<li>
<p>Using Ctrl-Arrow the user can navigate up and down the model/AST.</p>
</li>
<li>
<p>When an element is selected, it can be deleted with the DEL key.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_step_1_create_new_model_elements"><a class="anchor" href="#_step_1_create_new_model_elements"></a>Step 1: Create new Model Elements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We want the user to be able to add a new entity to the model.
For this we define an action.</p>
</div>
<div class="paragraph">
<p>First of all we add an <code>AliasBox</code>  at the end of the vertical list of entities.
Note the role of the box: "end-of-entity-list"</p>
</div>
<div class="listingblock">
<div class="title">AliasBox</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">    private createModelBox4(model: DemoModel): Box {
        return new VerticalListBox(model, "model", [
            new HorizontalListBox(model, "model-info", [
                new LabelBox(model, "model-keyword", "DemoModel", {
                    style: demoStyles.keyword
                }),
                new TextBox(model, "model-name", () =&gt; model.name, (c: string) =&gt; (model.name = c), {
                    placeHolder: "&lt;name&gt;"
                })
            ]),
            new LabelBox(model, "entity-list", "Entities", {
                style: demoStyles.keyword
            }),
            new VerticalListBox(
                model,
                "entities",
                model.entities.map(ent =&gt; {
                    return this.createEntityBox3(ent);
                })
            ).addChild(new AliasBox(model, "end-of-entity-list",
                "add entity", { style: demoStyles.indent }))        <i class="conum" data-value="1"></i><b>(1)</b>
        ]);
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>AliasBox</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Secondly we define an action.</p>
</div>
<div class="listingblock">
<div class="title">Attach Action to AliasBox</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">    {
        activeInBoxRoles: ["end-of-entity-list"],                                       <i class="conum" data-value="1"></i><b>(1)</b>
        trigger: "entity",                                                              <i class="conum" data-value="2"></i><b>(2)</b>
        action: (box: Box, trigger: PiTriggerType, ed: PiEditor): PiElement | null =&gt; { <i class="conum" data-value="3"></i><b>(3)</b>
            var model: DemoModel = box.element as DemoModel;
            const entity: DemoEntity = new DemoEntity();
            model.entities.push(entity);
            return entity;
        },
        boxRoleToSelect: "entity-name"                                                  <i class="conum" data-value="4"></i><b>(4)</b>
    },</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>the action is attached to each box with the role "end-of-entity-list".
This means that the action can be triggered in the <code>AliasBox</code> we defined in the projection.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>we define that the action will be triggered when the user types <code>"entity"</code> inside the.alias box.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>At &lt;3&gt; we define the executable code for the action. It creates a new <code>DemoEntity</code> and attaches is to the <code>DemoModel</code></p>
</div>
<div class="paragraph">
<p>At &lt;4&gt; we define the focus of the editor. The <code>Box</code>  with the role <code>"entity-name"</code>
within the entity as returned from the <code>action</code> code will get the editor focus.
This ensures that the user can immediately start typing the name of the entity after it has been created.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_step_2_create_new_attributes"><a class="anchor" href="#_step_2_create_new_attributes"></a>Step 2 Create new Attributes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Enable the creation of a new <code>DemoAttribute</code> is done similar to the creation of a new <code>DemoEntity</code>.</p>
</div>
<div class="paragraph">
<p>First we add an <code>AliasBox</code> to the projection of the attribute list:</p>
</div>
<div class="listingblock">
<div class="title">Add AliasBox to Attribute List</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">                new VerticalListBox(entity,"attributes",
                    entity.attributes.map(att =&gt; {
                        return this.createAttributeBox(att);
                    })
                ).addChild(new AliasBox(entity, "end-of-attribute-list",
                    "add attribute", { style: demoStyles.indent }))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we create the actual action and attach it to the role of the <code>AliasBox</code>.</p>
</div>
<div class="listingblock">
<div class="title">Attach Create Attribute Action to AliasBox</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">    {
        trigger: "attribute",
        activeInBoxRoles: ["end-of-attribute-list"],
        action: (box: Box, trigger: PiTriggerType, editor: PiEditor): PiElement | null =&gt; {
            var entity: DemoEntity = box.element as DemoEntity;
            const attribute: DemoAttribute = new DemoAttribute();
            entity.attributes.push(attribute);
            return attribute;
        },
        boxRoleToSelect: "attribute-name"
    },</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, there can be many boxes with the same role in the editor, as long as their model element is different.
This way,  the above action is available for each attribute list in each entity.</p>
</div>
</div>
</div>
</article>
  </main>
</div>
<footer class="footer">
  <p>This page was built using Antora.</p>
</footer>
<script src="../../../../_/js/site.js"></script>
<script src="../../../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
