:imagesdir: ../../assets/images/
:src-dir: ../../../../../..
:projectitdir: ../../../../../../core
:source-language: javascript

= Tutorial: How to Use the ProjectIt Framework

The ProjectIt Framework offers two axes along which you can specify your editor: (1) <<Define your Projection>> and (2) <<Define your Own Actions>>.

= Define your Projection

In this tutorial we will use the xref:projectit-main:../DemoLanguage-Example.adoc[DemoLanguage], a simple language where a model has entities, and entities have attributes, as example.

The projections in this tutorial are all available in `packages/demo/src/editor/TutorialProjection.ts`.

== Default Projection of the Model Name
The name of the model in our DemoLanguage is the value of the attribute _name_ of class _DemoModel_

.Model Element
[source]
----
include::{src-dir}/demo/src/model/DemoModel.ts[tag=DemoModel]
----

The default projection for this is a `HorizontalListBox` which holds a 'LabelBox' with the name of the class, followed by the value stored in the variable model.name. In the tutorial example this value is "DemoModel". When we start the editor based on this projection, we see the following:

image::demomodel-name.png[align="left"]

It doesn't look very nice currently:

- The label is not distinguishable from the name of the model.
- When the name of the model becomes empty, there is no visual clue that you can add a name.

== Step 1 - Adding Style
Let's have a look at the code that implements the projection:

.Default Projection
[source]
----
include::{src-dir}/demo/src/editor/TutorialProjection.ts[tag=ModelBox1]
----
Next we add a style to the LabelBox:

.Projection with Style and Placeholder
[source]
----
include::{src-dir}/demo/src/editor/TutorialProjection.ts[tag=ModelBox2]
----

The `LabelBox` now has the style `demoStyles.keyword` associated with it, so it will show in a different color.
Also, the `TextBox` has a `placeHolder` property.  This placeholder will show whenever the contents of the `TextBox` 
is empty, giving the user a visual clue that a name could be entered. 

The result is:

image::demomodel-name-with-style.png[align="left"]

The style is defined in a css (or actually scss) as follows. In principle all CSS styles can be used here.

.CSS for Styled Projection
[source, language=css]
----
include::{src-dir}/demo/src/styles/style.scss[tag=StyleKeyword]
----

== Step 3 - Showing Contained Elements

We will add the entities owned by the `DemoModel` to the projection.

.Projection of Child Elements
[source]
----
include::{src-dir}/demo/src/editor/TutorialProjection.ts[tag=ModelBox3]
----
The entities will be below the model name and for this we use a `VerticalListBox`.
First we show the model keyword plus its name,
the we show the keyword _Entities_,
followed by another `VerticalListBox` of all entities.
The projection of an entity is defined in a separate function:

.Projection of Entity
[source]
----
include::{src-dir}/demo/src/editor/TutorialProjection.ts[tag=EntityBox]
----
This function is very similar to the projection of the model box,
showing the keyword _Entity_ followed by its name and below all attributes of the
entity in a `VerticalListBox`.

Once again, the projection of an attribute is defined in its own function.

.Projection of Attribute
[source]
----
include::{src-dir}/demo/src/editor/TutorialProjection.ts[tag=AttributeBox]
----

== Step 4 - Allow Creation of new Elements in the Editor

The projection sofar is exactly that: a projection.
There are no actions defined yet, which we need to make a functioning editor.

This step is explained in the xref:tutorials/Actions-Tutorial.adoc[Actions] tutorial.


== Define your Own Actions 

In the xref:tutorials/Projection-Tutorial.adoc[Projection Tutorial] we started out by creating a projection of the DemoModel.
In this tutorial we will add actions to the editor,
to enable the user to change the model and add elements to it.

First of all take a look at the built-in default behavior of the editor:

- Inside a TextBox the text can be edited.
- Using the arrow keys the user can navigate the projection.
- Using Ctrl-Arrow the user can navigate up and down the model/AST.
- When an element is selected, it can be deleted with the DEL key.

== Step 1: Create new Model Elements
We want the user to be able to add a new entity to the model.
For this we define an action.

First of all we add an `AliasBox`  at the end of the vertical list of entities.
Note the role of the box: "end-of-entity-list"

.AliasBox
[source]
----
include::{src-dir}/demo/src/editor/TutorialProjection.ts[tag=ModelBox4]
----
<1> The `AliasBox`.

Secondly we define an action.

.Attach Action to AliasBox
[source]
----
include::{src-dir}/demo/src/editor/DemoActions.ts[tag=CreateEntityAction]
----
<1> the action is attached to each box with the role "end-of-entity-list".
This means that the action can be triggered in the `AliasBox` we defined in the projection.

<2> we define that the action will be triggered when the user types `"entity"` inside the.alias box.

At <3> we define the executable code for the action. It creates a new `DemoEntity` and attaches is to the `DemoModel`

At <4> we define the focus of the editor. The `Box`  with the role `"entity-name"`
within the entity as returned from the `action` code will get the editor focus.
This ensures that the user can immediately start typing the name of the entity after it has been created.

== Step 2 Create new Attributes
Enable the creation of a new `DemoAttribute` is done similar to the creation of a new `DemoEntity`.

First we add an `AliasBox` to the projection of the attribute list:

.Add AliasBox to Attribute List
[source]
----
include::{src-dir}/demo/src/editor/TutorialProjection.ts[tag=CreateAttributeAction]
----

Then we create the actual action and attach it to the role of the `AliasBox`.

.Attach Create Attribute Action to AliasBox
[source]
----
include::{src-dir}/demo/src/editor/DemoActions.ts[tag=CreateAttributeAction]
----

As you can see, there can be many boxes with the same role in the editor, as long as their model element is different.
This way,  the above action is available for each attribute list in each entity.

